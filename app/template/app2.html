<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
  </head>
  <body>
    <a id="button">Opens a new window</a>
    <script type="application/javascript">
      var gui = require('nw.gui')
      var win = gui.Window.get()

      // DOM is ready
      win.window.onload = function() {
        // opens new window
        document.getElementById('button').addEventListener('click', function() {
          new Promise(function(resolve, reject) {
            setTimeout(function() {
              resolve('something')
            }, 1000)
          }).then(function(msg) {
            console.log('got message', msg);
            setTimeout(function() {
              window.open('app.html')
            }, 1);
          });
        }, false);
      };
    </script>
  </body>
</html>